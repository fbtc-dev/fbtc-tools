from ..verifier import Verifier
from ..reqdata import RequestData

ConfirmMintRequestData = "{\"org_id\": \"3aM7ZZUr6ZKjtPekizBZx9S6MyswfchjXqaaq2LDwdbCYy5M8xf2TRwvP5horeVokzaSNr9wFEgqjuyBwRsKi8vywSjX3yZxJwkvpcemsjfGTLoCRjB3WugscYCrBTntDLGKvmqpg\", \"transaction_type\": \"Contract\", \"wallet_name\": \"FBTC Minter\", \"chain\": \"Ethereum Sepolia Testnet\", \"initiator\": \"API\", \"request_id\": \"042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5:0xaa36a7\", \"id\": \"20240516165931000335308000003663\", \"created_time\": 1715849971, \"from\": \"0x772101dde0b084e6354a6f5bb8ed57b8fa08e7f2\", \"to\": \"0x9cb74e884580131f6d965a0c66c6ed29d3aa3afc\", \"protocol\": {\"name\": \"\", \"url\": \"\"}, \"value\": \"0 SETH\", \"fee\": {\"gas_fee\": {\"fee\": \"0.025667638292849367\", \"gas_price\": \"0.000000174376096611\", \"gas_limit\": \"147197\"}, \"priority_fee\": null, \"max_fee\": null, \"fee_coin\": \"SETH\", \"gas_unit\": \"SETH\"}, \"message\": \"\", \"estimated_fee\": \"0.025667638292849367 SETH\\uff081.74376096611E-7 SETH * 147197\\uff09\", \"note\": \"{\\n    \\\"bridge_tx_info\\\": {\\n        \\\"chain_id\\\": \\\"0xaa36a7\\\",\\n        \\\"bridge_request_hash\\\": \\\"0x042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5\\\",\\n        \\\"btc_deposit_tx_id\\\": \\\"3a891e1222e86279b885c16d1a0bfe619b6d3e96ec4b9fe8b7e187895ad8c548\\\",\\n        \\\"add_mint_request_tx_id\\\": \\\"0x2f429e49d5c447695e5ad12971f1745905ab5ab9fbac069b410ed5327ae6c3ce\\\"\\n    }\\n}\", \"from_address_label\": \"\", \"to_address_label\": \"\", \"customs\": [{\"calldata\": [\"2bf90baa042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5\"]}, {\"name\": [\"confirmMintRequest\"]}, {\"function\": [\"confirmMintRequest(bytes32)\"]}, {\"params.hash\": [\"042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5\"]}], \"export_json\": true, \"raw_data\": {\"id\": \"20240516165931000335308000003663\", \"api_request_id\": \"042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5:0xaa36a7\", \"transaction_type\": 303, \"operation\": 200, \"coin\": \"SETH\", \"from_address\": \"0x772101dde0b084e6354a6f5bb8ed57b8fa08e7f2\", \"amount\": \"0\", \"to_address\": \"0x9cb74e884580131f6d965a0c66c6ed29d3aa3afc\", \"to_address_details\": \"\", \"fee\": 0, \"gas_price\": 1, \"gas_limit\": 0, \"api_key\": \"026c035f5406daa191e836e1dab16e63c09434654db2e4e06e57abab100f31b2f0\", \"spender\": \"\", \"operator\": \"\", \"extra_parameters\": \"{\\\"calldata\\\":\\\"2bf90baa042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5\\\"}\", \"note\": \"{\\n    \\\"bridge_tx_info\\\": {\\n        \\\"chain_id\\\": \\\"0xaa36a7\\\",\\n        \\\"bridge_request_hash\\\": \\\"0x042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5\\\",\\n        \\\"btc_deposit_tx_id\\\": \\\"3a891e1222e86279b885c16d1a0bfe619b6d3e96ec4b9fe8b7e187895ad8c548\\\",\\n        \\\"add_mint_request_tx_id\\\": \\\"0x2f429e49d5c447695e5ad12971f1745905ab5ab9fbac069b410ed5327ae6c3ce\\\"\\n    }\\n}\", \"replace_id\": \"\", \"decimal\": 18, \"gas_station_child_id\": \"\", \"custody_wallet_name\": \"FBTC Minter\"}, \"template_version\": \"1.0.1\", \"language\": \"en\", \"audit_role\": \"approver\", \"timestamp\": 1715849974, \"title\": \"Approver Approval\"}"
"""
from: 0x772101dde0b084e6354a6f5bb8ed57b8fa08e7f2
to: 0x9cb74e884580131f6d965a0c66c6ed29d3aa3afc
data: 2bf90baa042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5
value: 0
info: {'chain_id': '0xaa36a7', 'bridge_request_hash': '0x042c45f4dc24003966c01b4140383cbe0db7557495cb229d1f52b618708061b5', 'btc_deposit_tx_id': '3a891e1222e86279b885c16d1a0bfe619b6d3e96ec4b9fe8b7e187895ad8c548', 'add_mint_request_tx_id': '0x2f429e49d5c447695e5ad12971f1745905ab5ab9fbac069b410ed5327ae6c3ce'}
"""

ConfirmBurnRequestData = "{\"org_id\": \"3aM7ZZUr6ZKjtPekizBZx9S6MyswfchjXqaaq2LDwdbCYy5M8xf2TRwvP5horeVokzaSNr9wFEgqjuyBwRsKi8vywSjX3yZxJwkvpcemsjfGTLoCRjB3WugscYCrBTntDLGKvmqpg\", \"transaction_type\": \"Contract\", \"wallet_name\": \"FBTC Burner\", \"chain\": \"Ethereum Sepolia Testnet\", \"initiator\": \"API\", \"request_id\": \"1715909706613\", \"id\": \"20240517093508000315534000003819\", \"created_time\": 1715909708, \"from\": \"0x2f8125ed803e2928f4eed2e8cf68aee349fa7219\", \"to\": \"0xE5544A27b9eBCc315E4314723C1A03113C48cc95\", \"protocol\": {\"name\": \"\", \"url\": \"\"}, \"value\": \"0 SETH\", \"fee\": {\"gas_fee\": {\"fee\": \"0.0000000000021\", \"gas_price\": \"0.0000000000000001\", \"gas_limit\": \"21000\"}, \"priority_fee\": null, \"max_fee\": null, \"fee_coin\": \"SETH\", \"gas_unit\": \"SETH\"}, \"message\": \"\", \"estimated_fee\": \"0.0000000000021 SETH\\uff081E-16 SETH * 21000\\uff09\", \"note\": \"\", \"from_address_label\": \"\", \"to_address_label\": \"\", \"customs\": [{\"calldata\": [\"2313e70eb2d7b1b642e66ad4021a2b852450a990c0f1c5fc5ccaee9fd7d2da643f9a6fe4a1f72d676319ad71f44172844228a14f0e0ff99ba1a98a04efb8fb01bbd8436d0000000000000000000000000000000000000000000000000000000000000000\"]}, {\"name\": [\"confirmBurnRequest\"]}, {\"function\": [\"confirmBurnRequest(bytes32,bytes32,uint256)\"]}, {\"params.hash\": [\"b2d7b1b642e66ad4021a2b852450a990c0f1c5fc5ccaee9fd7d2da643f9a6fe4\"]}, {\"params.withdrawalTxid\": [\"a1f72d676319ad71f44172844228a14f0e0ff99ba1a98a04efb8fb01bbd8436d\"]}, {\"params.outputIndex\": [\"0\"]}], \"export_json\": true, \"raw_data\": {\"id\": \"20240517093508000315534000003819\", \"api_request_id\": \"1715909706613\", \"transaction_type\": 303, \"operation\": 100, \"coin\": \"SETH\", \"from_address\": \"0x2f8125ed803e2928f4eed2e8cf68aee349fa7219\", \"amount\": \"0\", \"to_address\": \"0xE5544A27b9eBCc315E4314723C1A03113C48cc95\", \"to_address_details\": \"\", \"fee\": 0, \"gas_price\": 1, \"gas_limit\": 0, \"api_key\": \"028a0b1ebe9369e41d4dbaf4ee7b79088eec91c708c9270638fbc6da72e5b2a253\", \"spender\": \"\", \"operator\": \"\", \"extra_parameters\": \"{\\\"calldata\\\":\\\"2313e70eb2d7b1b642e66ad4021a2b852450a990c0f1c5fc5ccaee9fd7d2da643f9a6fe4a1f72d676319ad71f44172844228a14f0e0ff99ba1a98a04efb8fb01bbd8436d0000000000000000000000000000000000000000000000000000000000000000\\\"}\", \"note\": \"\", \"replace_id\": \"\", \"decimal\": 18, \"gas_station_child_id\": \"\", \"custody_wallet_name\": \"FBTC Burner\"}, \"template_version\": \"1.0.1\", \"language\": \"en\", \"audit_role\": \"approver\", \"timestamp\": 1715909710, \"title\": \"Approver Approval\"}"
"""
from: 0x2f8125ed803e2928f4eed2e8cf68aee349fa7219
to: 0xE5544A27b9eBCc315E4314723C1A03113C48cc95
data: 2313e70eb2d7b1b642e66ad4021a2b852450a990c0f1c5fc5ccaee9fd7d2da643f9a6fe4a1f72d676319ad71f44172844228a14f0e0ff99ba1a98a04efb8fb01bbd8436d0000000000000000000000000000000000000000000000000000000000000000
value: 0
info: None
"""

BTCWithdrawalData = "{\"org_id\": \"3aM7ZZUr6ZKjtPekizBZx9S6MyswfchjXqaaq2LDwdbCYy5M8xf2TRwvP5horeVokzaSNr9wFEgqjuyBwRsKi8vywSjX3yZxJwkvpcemsjfGTLoCRjB3WugscYCrBTntDLGKvmqpg\", \"transaction_type\": \"Withdraw\", \"wallet_name\": \"BTC Pool\", \"chain\": \"Bitcoin Testnet3\", \"initiator\": \"API\", \"request_id\": \"1715909924805\", \"id\": \"20240517093846000393998000003544\", \"created_time\": 1715909926, \"from\": \"2N9BFPjRHSAAxVKYA55gyZzjg45bpYJ4XBx\", \"to\": \"2N9BFPjRHSAAxVKYA55gyZzjg45bpYJ4XBx\", \"protocol\": {\"name\": \"\", \"url\": \"\"}, \"value\": \"0.00009 XTN\", \"fee\": {\"gas_fee\": {\"fee\": \"0.00000455\"}, \"priority_fee\": null, \"max_fee\": null, \"fee_coin\": \"XTN\", \"gas_unit\": \"SAT/BYTE\"}, \"message\": \"\", \"estimated_fee\": \"0.00000455 XTN\", \"note\": \"{\\n    \\\"bridge_tx_info\\\": {\\n        \\\"chain_id\\\": \\\"0xaa36a7\\\",\\n        \\\"bridge_request_hash\\\": \\\"0xb2d7b1b642e66ad4021a2b852450a990c0f1c5fc5ccaee9fd7d2da643f9a6fe4\\\",\\n        \\\"add_burn_request_tx_id\\\": \\\"0x0f52563a442354b996aaf5dd661790eab7dc434ba06480e4dacf793a32eddc35\\\"\\n    }\\n}\", \"from_address_label\": \"\", \"to_address_label\": \"\", \"customs\": [], \"export_json\": true, \"raw_data\": {\"id\": \"20240517093846000393998000003544\", \"api_request_id\": \"1715909924805\", \"transaction_type\": 102, \"operation\": 100, \"coin\": \"XTN\", \"from_address\": \"2N9BFPjRHSAAxVKYA55gyZzjg45bpYJ4XBx\", \"amount\": \"9000\", \"to_address\": \"2N9BFPjRHSAAxVKYA55gyZzjg45bpYJ4XBx\", \"to_address_details\": \"\", \"fee\": 0, \"gas_price\": 1, \"gas_limit\": 0, \"api_key\": \"0231416e283748a467d52809294d546a43b83aef109522c30ddcf1bb37ccc96de7\", \"spender\": \"\", \"operator\": \"\", \"extra_parameters\": \"\", \"note\": \"{\\n    \\\"bridge_tx_info\\\": {\\n        \\\"chain_id\\\": \\\"0xaa36a7\\\",\\n        \\\"bridge_request_hash\\\": \\\"0xb2d7b1b642e66ad4021a2b852450a990c0f1c5fc5ccaee9fd7d2da643f9a6fe4\\\",\\n        \\\"add_burn_request_tx_id\\\": \\\"0x0f52563a442354b996aaf5dd661790eab7dc434ba06480e4dacf793a32eddc35\\\"\\n    }\\n}\", \"replace_id\": \"\", \"decimal\": 8, \"gas_station_child_id\": \"\", \"custody_wallet_name\": \"BTC Pool\"}, \"template_version\": \"1.0.1\", \"language\": \"en\", \"audit_role\": \"approver\", \"timestamp\": 1715909930, \"title\": \"Approver Approval\"}"
"""
to: 2N9BFPjRHSAAxVKYA55gyZzjg45bpYJ4XBx
data: None
value: 9000
info: {'chain_id': '0xaa36a7', 'bridge_request_hash': '0xb2d7b1b642e66ad4021a2b852450a990c0f1c5fc5ccaee9fd7d2da643f9a6fe4', 'add_burn_request_tx_id': '0x0f52563a442354b996aaf5dd661790eab7dc434ba06480e4dacf793a32eddc35'}
"""

def test_verify_mint():
    v = Verifier(
        "0x97b61375C59D81be63c32662316F5d6A3Be4D43f"
    )

    v.verify_request(RequestData(ConfirmMintRequestData))

def test_verify_withdraw():
    v = Verifier(
        "0x969D7485a3E44a5a70B95Ababa8945CF275b84E5"
    )

    v.verify_request(RequestData(BTCWithdrawalData))